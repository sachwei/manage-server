webpackJsonp([13],{FMCe:function(t,e){},Xupd:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("//Fk"),i=a.n(r),n=a("Dd8w"),c=a.n(n),o=a("rczP"),s={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"estimate-bar-wrapper"},[this._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"estimate-bar"},[e("i",{staticClass:"fa fa-gavel"})])}]};var l=a("VU/8")({data:function(){return{}},components:{},methods:{}},s,!1,function(t){a("aX8o")},"data-v-f0809994",null).exports,u=a("pRFn"),m=a("clvE"),d=a("2U4A"),p=a("NYxO"),f={components:{quillEditor:o.a,estimateBar:l,backlogTrackSelect:u.a,enumSelect:m.a,formItem:d.a},data:function(){return{tableName:"backlogs",back:!0,dataRule:{name:[{required:!0,message:"请输入故事名称",trigger:"change"}],track:[{required:!0,message:"请输入类别",trigger:"change"}],note:[{required:!0,message:"请输入备注",trigger:"blur"}]}}},computed:{userList:function(){return this.$store.state.userList},productId:function(){return this.$store.state.backlog.product.id}},methods:c()({initParam:function(){var t=this,e=this.$route.params.id;e?this.curData=this.$store.getters.getBacklog(e):this.getId().then(function(e){t.newDataForm(e)})},openImage:function(){this.$router.push({name:"imageView"})},validate:function(){var t=this;return new i.a(function(e,a){t.$refs.backlogForm.validate(function(t){t?e(t):a(new Error)})})},onOnlySave:function(){this.back=!1,this.onSave()},onSaveAndBack:function(){this.back=!0,this.onSave()},onSave:function(){var t=this;this.validate().then(function(){t.curData._id?t.doUpdate().then(function(e){t.updateBacklog(t.curData),t.afterSave()}):t.newBacklog(t.curData).then(function(e){t.curData=e,t.afterSave()})})},afterSave:function(){this.back&&this.goBack()},getId:function(){return this.getSequence("backlog_key")},newDataForm:function(t){this.curData={id:t,important:50,estimate:0,state:0,orgId:this.user.orgId,createUserId:this.user.email,createDate:new Date}},onOpenEstimate:function(){this.$router.push({name:"estimate",params:{id:this.curData.id}})}},Object(p.d)(["updateBacklog"]),Object(p.b)(["newBacklog"]))},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("panel",[a("div",{staticClass:"backlog-detail-wrapper"},[a("el-form",{ref:"backlogForm",staticClass:"backlog-detail-form",staticStyle:{width:"98%"},attrs:{rules:t.dataRule,model:t.curData}},[a("el-form-item",[a("form-item",{attrs:{title:"名称",titleSpan:2,itemSpan:8,prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.curData.name,callback:function(e){t.$set(t.curData,"name",e)},expression:"curData.name"}})],1),t._v(" "),a("form-item",{attrs:{title:"类别",titleSpan:2,itemSpan:8,prop:"track"}},[a("backlog-track-select",{attrs:{productId:t.productId},model:{value:t.curData.track,callback:function(e){t.$set(t.curData,"track",e)},expression:"curData.track"}})],1)],1),t._v(" "),a("el-form-item",[a("form-item",{attrs:{title:"UI",titleSpan:2,itemSpan:8}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!0,filterable:"",placeholder:"请选择"},model:{value:t.curData.uiUserId,callback:function(e){t.$set(t.curData,"uiUserId",e)},expression:"curData.uiUserId"}},t._l(t.userList,function(t){return a("el-option",{key:t.email,attrs:{label:t.userName,value:t.email}})}))],1),t._v(" "),a("form-item",{attrs:{title:"测试",titleSpan:2,itemSpan:8}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!0,filterable:"",placeholder:"请选择"},model:{value:t.curData.testUserId,callback:function(e){t.$set(t.curData,"testUserId",e)},expression:"curData.testUserId"}},t._l(t.userList,function(t){return a("el-option",{key:t.email,attrs:{label:t.userName,value:t.email}})}))],1)],1),t._v(" "),a("el-form-item",[a("form-item",{attrs:{title:"重要级别",titleSpan:2,itemSpan:8,prop:"important"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.curData.important,callback:function(e){t.$set(t.curData,"important",e)},expression:"curData.important"}})],1),t._v(" "),a("form-item",{attrs:{title:"故事来源",titleSpan:2,itemSpan:8,prop:"where"}},[a("enum-select",{attrs:{enumTypeKey:"BACKLOG_WHERE"},model:{value:t.curData.where,callback:function(e){t.$set(t.curData,"where",e)},expression:"curData.where"}})],1)],1),t._v(" "),a("el-form-item",[a("form-item",{attrs:{title:"如何演示",titleSpan:2,itemSpan:22,prop:"how"}},[a("quill-editor",{staticStyle:{height:"400px"},model:{value:t.curData.how,callback:function(e){t.$set(t.curData,"how",e)},expression:"curData.how"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"backlog-detail-footer"},[a("el-button",{on:{click:t.goBack}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.onOnlySave}},[t._v("仅保存")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.onSaveAndBack}},[t._v("保存并返回")])],1)],1),t._v(" "),a("estimate-bar",{directives:[{name:"show",rawName:"v-show",value:t.curData._id,expression:"curData._id"}],nativeOn:{click:function(e){return t.onOpenEstimate(e)}}}),t._v(" "),a("transition",{attrs:{mode:"out-in",name:"fade",appear:""}},[a("router-view")],1)],1)},staticRenderFns:[]};var h=a("VU/8")(f,v,!1,function(t){a("rkt/"),a("FMCe")},"data-v-3fe12281",null);e.default=h.exports},aX8o:function(t,e){},"rkt/":function(t,e){}});
//# sourceMappingURL=13.8f551067213cd86bcbbb.js.map
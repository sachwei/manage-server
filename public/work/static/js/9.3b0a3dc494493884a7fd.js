webpackJsonp([9],{"3CFJ":function(t,e){},"7KGu":function(t,e,i){"use strict";var r=i("Dd8w"),n=i.n(r),s=i("NYxO"),a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{placement:"bottom-end",width:"300",trigger:"click"},on:{show:function(e){t.onShowBugOrbit(t.bug.id)}}},[i("ul",t._l(t.bugOrbit,function(e,r){return i("li",{key:e._id},[i("span",[t._v(t._s(r+1)+".\n        "),i("span",{staticClass:"user-name"},[t._v(t._s(t._f("userFilter")(e.optUserId,t.userList)))]),t._v(" "),e.fromUserId?i("span",[i("span",[t._v("将单据状态置为“"+t._s(t.enumFormatter("BUG_STATE",e.state))+"”")]),t._v(" "),i("span",[t._v(", 给了")]),t._v(" "),i("span",{staticClass:"user-name"},[t._v(t._s(t._f("userFilter")(e.toUserId,t.userList)))])]):i("span",[t._v("创建了该缺陷单")]),t._v(" "),i("span",{staticClass:"opt-time"},[t._v(" "+t._s(t._f("dateFilter")(e.optTime,"MM-dd hh:mm:ss")))])])])})),t._v(" "),i("div",{attrs:{slot:"reference"},slot:"reference"},[i("span",[t._v(t._s(t._f("userFilter")(t.bug.curUserId,t.userList)))]),t._v(" "),i("i",{staticClass:"fa fa-angle-double-down margin-left-5"})])])},staticRenderFns:[]};var o={data:function(){return{levels:[],levelFilter:[],states:[],stateFilter:[],userFilter:[],tableName:"bugs"}},components:{bugOrbit:i("VU/8")({props:["bug"],data:function(){return{bugOrbit:[]}},computed:{userList:function(){return this.$store.state.userList}},methods:{onShowBugOrbit:function(t){var e=this;this.findCondition={bugId:t},this.findDataByCondition("bugOrbit").then(function(t){e.bugOrbit=t})},stateFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_STATE",i)}}},a,!1,function(t){i("3CFJ")},"data-v-947bba74",null).exports},computed:{userList:function(){return this.$store.state.userList},bugList:function(){return this.$store.getters.filterBugList},tableHeight:function(){return this.$utils.getClientHeight()-120}},watch:{bugList:function(){this.calcFilter()}},methods:n()({initData:function(){var t=this;this.$enumService.getEnum("BUG_LEVEL").then(function(e){return t.levels=e,t.$enumService.getEnum("BUG_STATE")}).then(function(e){t.states=e,t.calcFilter()})},calcFilter:function(){var t=this;this.levelFilter=[],this.stateFilter=[],this.userFilter=[],this.levels.forEach(function(e){t.levelFilter.push({text:e.name,value:e.id})}),this.states.forEach(function(e){t.stateFilter.push({text:e.name,value:e.id})}),this.bugList.forEach(function(e){t.userFilter.find(function(t){return t.value===e.commitUser})||t.userFilter.push({text:t.$utils.userFormatter(e.commitUser,t.userList),value:e.commitUser})})},getId:function(){return this.getSequence("bug_key")},onCopy:function(t){var e=this;this.getId().then(function(i){e.curData=e.$utils.deepCopy(t),e.curData.id=i,e.curData.commentId="",e.curData.attachs=[],e.curData.name=e.curData.name+"[复制]",delete e.curData._id,e.doAdd().then(function(t){e.addBug(t)})})},hasImage:function(t){return t.find(function(t){return-1!==t.type.indexOf("image")})},hasVedio:function(t){return t.find(function(t){return-1!==t.type.indexOf("video")})},onBugEdit:function(t){this.$router.push({path:"list/detail",query:{id:t.id}})},doAfterDelete:function(t){this.deleteBug(t._id),this.doDeleteBugOrbit(t)},doDeleteBugOrbit:function(t){this.$dataService.delete(this.$apiUrl.BASE_DELETE+"bugs",{bugId:t.id})},levelFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_LEVEL",i)},stateFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_STATE",i)},filterHandler:function(t,e,i){return e[i.property]===t}},Object(s.d)(["deleteBug","addBug"]))},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.bugList,border:"",height:t.tableHeight}},[i("el-table-column",{attrs:{type:"index",width:"45"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",align:"center",width:"70",label:"编码"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"摘要"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t.hasImage(e.row.attachs)?i("i",{staticClass:"fa fa-image margin-left-5"}):t._e(),t._v(" "),t.hasVedio(e.row.attachs)?i("i",{staticClass:"fa fa-film"}):t._e(),t._v(" "),i("span",{staticClass:"bug-summary",on:{click:function(i){t.onBugEdit(e.row)}}},[t._v(t._s(e.row.name))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"level",width:"80",formatter:t.levelFormater,filters:t.levelFilter,"filter-method":t.filterHandler,label:"等级"}}),t._v(" "),i("el-table-column",{attrs:{prop:"state",width:"80",formatter:t.stateFormater,filters:t.stateFilter,"filter-method":t.filterHandler,label:"状态"}}),t._v(" "),i("el-table-column",{attrs:{prop:"commitUser",width:"90",formatter:t.userFormatter,filters:t.userFilter,"filter-method":t.filterHandler,label:"提交人"}}),t._v(" "),i("el-table-column",{attrs:{prop:"curUserId",width:"110",label:"当前处理人"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("bug-orbit",{attrs:{bug:t.row}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"createTime",width:"100",formatter:t.dateFormatter,label:"创建时间"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"quick-operation"},[i("i",{staticClass:"fa fa-edit",on:{click:function(i){t.onBugEdit(e.row)}}}),t._v(" "),i("i",{staticClass:"fa fa-copy",on:{click:function(i){t.onCopy(e.row)}}}),t._v(" "),i("i",{staticClass:"fa fa-trash",on:{click:function(i){t.onDelete(e.row)}}})])]}}])})],1)},staticRenderFns:[]};var l=i("VU/8")(o,u,!1,function(t){i("wGko"),i("xxpj")},"data-v-87f71a32",null);e.a=l.exports},U6of:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("Dd8w"),n=i.n(r),s=i("7KGu"),a=i("FixA"),o=i("VilE"),u=i("NYxO"),l={data:function(){return{selectProductId:void 0,sprintId:void 0,tableName:"bugs"}},computed:{productId:function(){return this.selectProductId}},watch:{selectProductId:function(){this.fingBugList()},sprintId:function(){this.setCurSprintId(this.sprintId),this.fingBugList()}},beforeDestroy:function(){this.$localStore.set("bugListCondition",{productId:this.selectProductId,sprintId:this.sprintId})},components:{bugList:s.a,sprintSelect:a.a,productSelect:o.a},methods:n()({initParam:function(){var t=this.$localStore.get("bugListCondition");t&&(this.selectProductId=t.productId,this.sprintId=t.sprintId)},initData:function(){this.setBugList([])},fingBugList:function(){var t=this;this.findCondition={productId:this.productId,sprintId:this.sprintId},this.findDataByCondition().then(function(e){setTimeout(function(){t.setBugList(e)},500)})},onAnalyse:function(){this.$router.push({name:"bugAnalyse"})},onExport:function(){var t=this,e={query:this.findCondition,sort:{createTime:-1}};this.$http.post("/excel/export/bug",e,{responseType:"arraybuffer"}).then(function(e){e&&e.data&&t.downloadExcel(e.data,"bugFile.xls")})}},Object(u.d)(["setCurSprintId","setBugList"]))},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("panel",[i("div",{staticClass:"bug-list-wrapper"},[i("div",{staticClass:"bug-list-toolbar"},[i("div",{staticClass:"toolbar-left"},[i("product-select",{staticClass:"product-select",model:{value:t.selectProductId,callback:function(e){t.selectProductId=e},expression:"selectProductId"}}),t._v(" "),i("sprint-select",{staticClass:"sprint-select margin-left-5",attrs:{state:[1,2,3],productId:t.productId},model:{value:t.sprintId,callback:function(e){t.sprintId=e},expression:"sprintId"}})],1),t._v(" "),i("div",{staticClass:"toolbar-right"},[i("i",{staticClass:"fa fa-pie-chart margin-right-10",on:{click:t.onAnalyse}}),t._v(" "),i("i",{staticClass:"fa fa-download margin-right-10",on:{click:t.onExport}})])]),t._v(" "),i("bug-list")],1),t._v(" "),i("transition",{attrs:{mode:"out-in",name:"fade",appear:""}},[i("router-view")],1)],1)},staticRenderFns:[]};var d=i("VU/8")(l,c,!1,function(t){i("gozZ")},"data-v-4450f5c4",null);e.default=d.exports},gozZ:function(t,e){},wGko:function(t,e){},xxpj:function(t,e){}});
//# sourceMappingURL=9.3b0a3dc494493884a7fd.js.map
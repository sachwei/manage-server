webpackJsonp([2],{"3CFJ":function(t,e){},"7KGu":function(t,e,i){"use strict";var r=i("Dd8w"),s=i.n(r),n=i("NYxO"),a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{placement:"bottom-end",width:"300",trigger:"click"},on:{show:function(e){t.onShowBugOrbit(t.bug.id)}}},[i("ul",t._l(t.bugOrbit,function(e,r){return i("li",{key:e._id},[i("span",[t._v(t._s(r+1)+".\n        "),i("span",{staticClass:"user-name"},[t._v(t._s(t._f("userFilter")(e.optUserId,t.userList)))]),t._v(" "),e.fromUserId?i("span",[i("span",[t._v("将单据状态置为“"+t._s(t.enumFormatter("BUG_STATE",e.state))+"”")]),t._v(" "),i("span",[t._v(", 给了")]),t._v(" "),i("span",{staticClass:"user-name"},[t._v(t._s(t._f("userFilter")(e.toUserId,t.userList)))])]):i("span",[t._v("创建了该缺陷单")]),t._v(" "),i("span",{staticClass:"opt-time"},[t._v(" "+t._s(t._f("dateFilter")(e.optTime,"MM-dd hh:mm:ss")))])])])})),t._v(" "),i("div",{attrs:{slot:"reference"},slot:"reference"},[i("span",[t._v(t._s(t._f("userFilter")(t.bug.curUserId,t.userList)))]),t._v(" "),i("i",{staticClass:"fa fa-angle-double-down margin-left-5"})])])},staticRenderFns:[]};var o={data:function(){return{levels:[],levelFilter:[],states:[],stateFilter:[],userFilter:[],tableName:"bugs"}},components:{bugOrbit:i("VU/8")({props:["bug"],data:function(){return{bugOrbit:[]}},computed:{userList:function(){return this.$store.state.userList}},methods:{onShowBugOrbit:function(t){var e=this;this.findCondition={bugId:t},this.findDataByCondition("bugOrbit").then(function(t){e.bugOrbit=t})},stateFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_STATE",i)}}},a,!1,function(t){i("3CFJ")},"data-v-947bba74",null).exports},computed:{userList:function(){return this.$store.state.userList},bugList:function(){return this.$store.getters.filterBugList},tableHeight:function(){return this.$utils.getClientHeight()-120}},watch:{bugList:function(){this.calcFilter()}},methods:s()({initData:function(){var t=this;this.$enumService.getEnum("BUG_LEVEL").then(function(e){return t.levels=e,t.$enumService.getEnum("BUG_STATE")}).then(function(e){t.states=e,t.calcFilter()})},calcFilter:function(){var t=this;this.levelFilter=[],this.stateFilter=[],this.userFilter=[],this.levels.forEach(function(e){t.levelFilter.push({text:e.name,value:e.id})}),this.states.forEach(function(e){t.stateFilter.push({text:e.name,value:e.id})}),this.bugList.forEach(function(e){t.userFilter.find(function(t){return t.value===e.commitUser})||t.userFilter.push({text:t.$utils.userFormatter(e.commitUser,t.userList),value:e.commitUser})})},getId:function(){return this.getSequence("bug_key")},onCopy:function(t){var e=this;this.getId().then(function(i){e.curData=e.$utils.deepCopy(t),e.curData.id=i,e.curData.commentId="",e.curData.attachs=[],e.curData.name=e.curData.name+"[复制]",delete e.curData._id,e.doAdd().then(function(t){e.addBug(t)})})},hasImage:function(t){return t.find(function(t){return-1!==t.type.indexOf("image")})},hasVedio:function(t){return t.find(function(t){return-1!==t.type.indexOf("video")})},onBugEdit:function(t){this.$router.push({path:"list/detail",query:{id:t.id}})},doAfterDelete:function(t){this.deleteBug(t._id),this.doDeleteBugOrbit(t)},doDeleteBugOrbit:function(t){this.$dataService.delete(this.$apiUrl.BASE_DELETE+"bugs",{bugId:t.id})},levelFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_LEVEL",i)},stateFormater:function(t,e,i){return this.$enumService.enumFormat("BUG_STATE",i)},filterHandler:function(t,e,i){return e[i.property]===t}},Object(n.d)(["deleteBug","addBug"]))},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.bugList,border:"",height:t.tableHeight}},[i("el-table-column",{attrs:{type:"index",width:"45"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",align:"center",width:"70",label:"编码"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"摘要"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t.hasImage(e.row.attachs)?i("i",{staticClass:"fa fa-image margin-left-5"}):t._e(),t._v(" "),t.hasVedio(e.row.attachs)?i("i",{staticClass:"fa fa-film"}):t._e(),t._v(" "),i("span",{staticClass:"bug-summary",on:{click:function(i){t.onBugEdit(e.row)}}},[t._v(t._s(e.row.name))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"level",width:"80",formatter:t.levelFormater,filters:t.levelFilter,"filter-method":t.filterHandler,label:"等级"}}),t._v(" "),i("el-table-column",{attrs:{prop:"state",width:"80",formatter:t.stateFormater,filters:t.stateFilter,"filter-method":t.filterHandler,label:"状态"}}),t._v(" "),i("el-table-column",{attrs:{prop:"commitUser",width:"90",formatter:t.userFormatter,filters:t.userFilter,"filter-method":t.filterHandler,label:"提交人"}}),t._v(" "),i("el-table-column",{attrs:{prop:"curUserId",width:"110",label:"当前处理人"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("bug-orbit",{attrs:{bug:t.row}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"createTime",width:"100",formatter:t.dateFormatter,label:"创建时间"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"quick-operation"},[i("i",{staticClass:"fa fa-edit",on:{click:function(i){t.onBugEdit(e.row)}}}),t._v(" "),i("i",{staticClass:"fa fa-copy",on:{click:function(i){t.onCopy(e.row)}}}),t._v(" "),i("i",{staticClass:"fa fa-trash",on:{click:function(i){t.onDelete(e.row)}}})])]}}])})],1)},staticRenderFns:[]};var l=i("VU/8")(o,u,!1,function(t){i("wGko"),i("xxpj")},"data-v-87f71a32",null);e.a=l.exports},"8+Dw":function(t,e){},"L/c8":function(t,e){},U6sJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("Dd8w"),s=i.n(r),n=i("NYxO"),a={props:["monthData"],data:function(){return{tableName:"rushJobs"}},methods:s()({calcDuration:function(t,e){var i=new Date(t);return((new Date(e).getTime()-i.getTime())/1e3/60/60).toFixed(1)},onEndRushJob:function(t){var e=this;this.$confirm("确认结束吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.doEndRushJob(t)})},doEndRushJob:function(t){var e=this;this.$set(t,"endTime",new Date),this.curData=t,this.doUpdate().then(function(i){e.updateRushJob(t)})},doAfterDelete:function(t){this.deleteRushJob(t)}},Object(n.d)(["updateRushJob","deleteRushJob"]))},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"month-record-wrapper el-card"},[i("div",{staticClass:"month-record-header"},[i("span",{staticClass:"month-title"},[t._v(t._s(t.monthData.month+"月"))])]),t._v(" "),i("div",{staticClass:"month-record-body"},t._l(t.monthData.data,function(e,r){return i("div",{key:r,staticClass:"month-record-item"},[e.endTime?i("div",{staticClass:"done-record-tag"}):i("div",{staticClass:"todo-record-tag"}),t._v(" "),i("div",{staticClass:"record-item-info"},[i("div",{staticClass:"record-time-info"},[i("span",{staticClass:"start-time"},[t._v(t._s(t._f("dateFilter")(e.startTime,"MM-dd hh:mm"))+"~")]),t._v(" "),e.endTime?i("span",{staticClass:"end-time"},[t._v(t._s(t._f("dateFilter")(e.endTime,"hh:mm")))]):t._e(),t._v(" "),e.endTime?i("span",{staticClass:"end-time"},[t._v("（"+t._s(t.calcDuration(e.startTime,e.endTime))+"小时）")]):i("span",{staticClass:"end-job-btn",on:{click:function(i){t.onEndRushJob(e)}}},[t._v("结束突击")]),t._v(" "),i("i",{staticClass:"fa fa-trash",on:{click:function(i){t.onDelete(e)}}})]),t._v(" "),i("span",{staticClass:"work-note text-ellipsis"},[t._v(t._s(e.workNote))])])])}))])},staticRenderFns:[]};var u=i("VU/8")(a,o,!1,function(t){i("e7On")},"data-v-8aae774c",null).exports,l=["2018-01-01","2018-02-15","2018-02-16","2018-02-17","2018-02-18","2018-02-19","2018-02-20","2018-02-21","2018-04-05","2018-04-06","2018-04-07","2018-04-29","2018-04-30","2018-05-01","2018-06-16","2018-06-17","2018-06-18","2018-09-22","2018-09-23","2018-09-24","2018-10-01","2018-10-02","2018-10-03","2018-10-04","2018-10-05","2018-10-06","2018-10-07"],c={data:function(){return{dialogFormVisible:!1,dataRule:{workNote:[{required:!0,trigger:"blur"}]},tableName:"rushJobs",jobDateTime:[],count:0}},watch:{jobDateTime:function(){this.curData.startTime=this.jobDateTime[0],this.curData.endTime=this.jobDateTime[1]}},methods:s()({newDataForm:function(){this.curData={userId:this.user.email,userName:this.user.userName,workNo:this.user.workNo,orgId:this.user.orgId,startTime:new Date,isHoliday:this.isHoliday(new Date)}},isHoliday:function(t){var e=!1,i=t;t&&(i=new Date);var r=this.$utils.formatDateTime(i,"yyy-mm-dd");-1!==l.indexOf(r)&&(e=!0);var s=i.getDate();return 0!==s&&6!==s||(e=!0),e},show:function(){this.count=0,this.dialogFormVisible=!0,this.newDataForm()},doAfterAdd:function(t){this.dialogFormVisible=!1,this.addRushJob(t)}},Object(n.d)(["addRushJob"]))},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:"新增",width:"38%",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}},nativeOn:{click:function(e){t.count+=1}}},[i("el-form",{ref:"dataForm",attrs:{model:t.curData,rules:t.dataRule}},[t.count>5?i("el-form-item",{attrs:{prop:"startTime"}},[i("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.jobDateTime,callback:function(e){t.jobDateTime=e},expression:"jobDateTime"}})],1):t._e(),t._v(" "),i("el-form-item",{attrs:{prop:"workNote"}},[i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"输入突击内容"},model:{value:t.curData.workNote,callback:function(e){t.$set(t.curData,"workNote",e)},expression:"curData.workNote"}})],1)],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.onSave}},[t._v("开始突击")])],1)],1)},staticRenderFns:[]};var f=i("VU/8")(c,d,!1,function(t){i("L/c8")},"data-v-c85ba490",null).exports,h={data:function(){return{workNumDialog:!1,tableName:"rushJobs",workNo:void 0}},components:{monthRecord:u,addButton:i("7NuJ").a,addRecordDialog:f},computed:{months:function(){for(var t=[],e=void 0,i=void 0,r=0,s=this.rushJobs.length;r<s;r++)(i=t[e=new Date(this.rushJobs[r].startTime).getMonth()+1])?i.data.push(this.rushJobs[r]):(i={month:e,data:[this.rushJobs[r]]},t[e]=i);return t=(t=t.filter(function(t){if(t.month)return t})).sort(function(t,e){return e.month-t.month})},rushJobs:function(){return this.$store.state.rushJob.rushJobs}},methods:s()({initParam:function(){this.user.workNo||(this.workNumDialog=!0)},initData:function(){this.findRushJobs(this.user.email)},openNewDialog:function(){this.user.workNo?this.$refs.addRecord.show():this.workNumDialog=!0},saveUser:function(){this.curData={_id:this.user._id,workNo:this.workNo},this.doUpdate("users")},doAfterUpdate:function(t){this.user.workNo=this.workNo,this.$localStore.set("user",this.user),this.workNumDialog=!1}},Object(n.b)(["findRushJobs"]))},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("panel",[i("div",{staticClass:"rush-job-wrapper"},[i("div",{staticClass:"rush-job-toolbar"},[i("add-button",{on:{onClick:t.openNewDialog}})],1),t._v(" "),i("div",{staticClass:"rush-job-body"},t._l(t.months,function(t,e){return i("month-record",{key:e,attrs:{monthData:t}})})),t._v(" "),i("add-record-dialog",{ref:"addRecord"}),t._v(" "),i("el-dialog",{attrs:{title:"提示",visible:t.workNumDialog,width:"30%"},on:{"update:visible":function(e){t.workNumDialog=e}}},[i("el-input",{attrs:{placeholder:"你好，请先输入你的工号"},model:{value:t.workNo,callback:function(e){t.workNo=e},expression:"workNo"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.workNumDialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.saveUser}},[t._v("保 存")])],1)],1)],1)])},staticRenderFns:[]};var p=i("VU/8")(h,m,!1,function(t){i("8+Dw")},"data-v-0230cf71",null);e.default=p.exports},Zqnr:function(t,e){},e7On:function(t,e){},sxAI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("Dd8w"),s=i.n(r),n=i("7KGu"),a=i("7NuJ"),o=i("NYxO"),u={components:{bugList:n.a,addButton:a.a},data:function(){return{sprintList:[],isTodo:"todo",curSprint:{},searchText:"",condition:{}}},watch:{curSprint:function(){this.curSprint&&this.curSprint.id&&this.setCurSprintId(this.curSprint.id)},isTodo:function(){this.setIsTodo(this.isTodo),this.initData()},searchText:function(){this.setFilterText(this.searchText)}},computed:{bugList:function(){return this.$store.state.bug.bugList}},methods:s()({initParam:function(){this.setBugList([])},initData:function(){var t=this;setTimeout(function(){t.findBugList().then(function(){t.findSprint()})},500)},onNewBug:function(){this.$router.push({path:"list/detail"})},findSprint:function(){var t=this;this.findDataByOrgId("sprints").then(function(e){t.filterSprint(e)})},filterSprint:function(t){var e=this;this.sprintList=t.filter(function(t){if(e.bugList.find(function(e){return e.sprintId===t.id}))return t}),this.curSprint=this.sprintList[0]}},Object(o.d)(["setCurSprintId","setIsTodo","setFilterText","setBugList"]),Object(o.b)(["findBugList"]))},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("panel",[i("div",{staticClass:"todo-wrapper"},[i("div",{staticClass:"todo-toolbar"},[i("div",{staticClass:"todo-toolbar-left"},[i("el-radio-group",{attrs:{size:"small"},model:{value:t.isTodo,callback:function(e){t.isTodo=e},expression:"isTodo"}},[i("el-radio-button",{attrs:{label:"todo"}},[t._v("待办")]),t._v(" "),i("el-radio-button",{attrs:{label:"done"}},[t._v("已办")])],1),t._v(" "),i("radio-group",{staticClass:"margin-left-10",attrs:{list:t.sprintList},model:{value:t.curSprint,callback:function(e){t.curSprint=e},expression:"curSprint"}})],1),t._v(" "),i("div",{staticClass:"todo-toolbar-right"},[i("el-input",{staticClass:"search-input margin-left-10",attrs:{placeholder:"编码 / 摘要","prefix-icon":"el-icon-search",size:"small"},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),i("add-button",{on:{onClick:t.onNewBug}})],1)]),t._v(" "),i("bug-list",{staticClass:"todo-table"}),t._v(" "),i("transition",{attrs:{mode:"out-in",name:"fade",appear:""}},[i("router-view")],1)],1)])},staticRenderFns:[]};var c=i("VU/8")(u,l,!1,function(t){i("Zqnr"),i("uuqn")},"data-v-207f2eca",null);e.default=c.exports},uuqn:function(t,e){},wGko:function(t,e){},xxpj:function(t,e){}});
//# sourceMappingURL=2.65684783d0452faa3064.js.map
webpackJsonp([20],{"DgQ+":function(e,t){},RVZ1:function(e,t){},dSQT:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("//Fk"),a=n.n(r),o={data:function(){return{defaultProps:{children:"children",label:"name",id:"id"},menuList:[],menuForm:{},newMenuForm:{},props:{value:"id",label:"name"},newMenuParent:[],menuParent:[]}},computed:{menuTreeData:function(){return this.$utils.arrayToTree(this.menuList)}},methods:{initData:function(){var e=this;this.findAllMenu().then(function(t){e.menuList=t,e.menuList.sort(function(e,t){return e.sort-t.sort}),e.newMenu()})},newMenu:function(){this.newMenuForm={id:this.$utils.getMaxId(this.menuList),pid:null,name:"",sort:0,icon:"",href:"",state:0,children:[]}},onUpdateMenu:function(){var e=this;this.menuForm.pid=this.menuParent&&this.menuParent.slice(0).pop(),this.$dataService.update(this.$apiUrl.SYS_UPDATE_MENU+this.menuForm._id,this.menuForm).then(function(t){e.updateMenuPid()})},updateMenuPid:function(){var e=this;this.menuList.forEach(function(t){t.id===e.menuForm.id&&(t.pid=e.menuForm.pid)})},onDeleteMenu:function(){var e=this;this.deleteConfirm().then(function(){e.deleteMenu()}).catch(function(){e.$notify({title:"警告",message:"不能删除非底层菜单",type:"warning"})})},deleteMenu:function(){var e=this;this.$dataService.deleteById(this.$apiUrl.SYS_DELETE_MENU+this.menuForm._id).then(function(t){e.menuList=e.menuList.filter(function(t){return t.id!==e.menuForm.id}),e.menuForm={},e.newMenuParent=[],e.menuParent=[]})},deleteConfirm:function(){var e=this;return new a.a(function(t,n){e.menuList.some(function(t){return t.pid===e.menuForm.id})?n(new Error):t()})},onAddMenu:function(){var e=this;this.newMenuForm.pid=this.newMenuParent.slice(0).pop(),this.$utils.appendTreeNode(this.menuTreeData,this.$utils.merge({},this.newMenuForm)),this.$dataService.save(this.$apiUrl.SYS_SAVE_MENU,this.newMenuForm).then(function(t){e.menuList.push(t),e.newMenu()})},nodeClick:function(e){this.newMenuParent=this.$utils.getCascadeValue(this.menuList,e.id),this.menuForm=e,this.menuParent=e.pid&&this.$utils.getCascadeValue(this.menuList,e.pid)},renderContent:function(e,t){var n=t.node,r=t.data;t.store;return e("span",{style:"font-size: 14px;"},[e("i",{class:r.icon})," ",n.label])}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("panel",[n("div",{staticClass:"menu-wrapper"},[n("div",{staticClass:"menu-content"},[n("el-card",{staticClass:"menu-tree"},[n("el-tree",{attrs:{data:e.menuTreeData,"show-checkbox":"","default-expand-all":!0,"highlight-current":"","render-content":e.renderContent,clearable:"","node-key":"id",props:e.defaultProps},on:{"node-click":e.nodeClick}})],1),e._v(" "),n("el-card",{staticClass:"box-card"},[n("el-form",{ref:"form",attrs:{model:e.newMenuForm,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"父级"}},[n("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.menuTreeData,"change-on-select":"",clearable:"",props:e.props},model:{value:e.newMenuParent,callback:function(t){e.newMenuParent=t},expression:"newMenuParent"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.newMenuForm.name,callback:function(t){e.$set(e.newMenuForm,"name",t)},expression:"newMenuForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"链接"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.newMenuForm.href,callback:function(t){e.$set(e.newMenuForm,"href",t)},expression:"newMenuForm.href"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"图标"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.newMenuForm.icon,callback:function(t){e.$set(e.newMenuForm,"icon",t)},expression:"newMenuForm.icon"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否启用"}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ddd","active-value":"1","inactive-value":"0"},model:{value:e.newMenuForm.state,callback:function(t){e.$set(e.newMenuForm,"state",t)},expression:"newMenuForm.state"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input-number",{model:{value:e.newMenuForm.sort,callback:function(t){e.$set(e.newMenuForm,"sort",t)},expression:"newMenuForm.sort"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.onAddMenu}},[e._v("新增")])],1)],1)],1),e._v(" "),n("el-card",{staticClass:"box-card"},[n("el-form",{ref:"form",attrs:{model:e.menuForm,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"父级"}},[n("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.menuTreeData,"change-on-select":"",props:e.props,clearable:""},model:{value:e.menuParent,callback:function(t){e.menuParent=t},expression:"menuParent"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"链接"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.menuForm.href,callback:function(t){e.$set(e.menuForm,"href",t)},expression:"menuForm.href"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"图标"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.menuForm.icon,callback:function(t){e.$set(e.menuForm,"icon",t)},expression:"menuForm.icon"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"是否启用"}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ddd","active-value":1,"inactive-value":0},model:{value:e.menuForm.state,callback:function(t){e.$set(e.menuForm,"state",t)},expression:"menuForm.state"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input-number",{model:{value:e.menuForm.sort,callback:function(t){e.$set(e.menuForm,"sort",t)},expression:"menuForm.sort"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:e.onUpdateMenu}},[e._v("修改")]),e._v(" "),n("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.onDeleteMenu}},[e._v("删除")])],1)],1)],1)],1)])])},staticRenderFns:[]};var l=n("VU/8")(o,i,!1,function(e){n("DgQ+"),n("RVZ1")},"data-v-1535865c",null);t.default=l.exports}});
//# sourceMappingURL=20.966477ece0e28bc78c80.js.map